<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LispBM: LispBM language reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LispBM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">LispBM language reference </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#sec_arith">Arithmetic</a></li>
<li class="level1"><a href="#sec_comp">Comparisons</a></li>
<li class="level1"><a href="#sec_bool">Boolean operators</a></li>
<li class="level1"><a href="#sec_bitwise">Bit level operations</a></li>
<li class="level1"><a href="#sec_low_level">Low level operations</a></li>
<li class="level1"><a href="#sec_nil">nil and t</a></li>
<li class="level1"><a href="#sec_quote">Quotes and Quasiquotation</a></li>
<li class="level1"><a href="#sec_builtin">Built-in operations</a></li>
<li class="level1"><a href="#sec_forms">Special forms</a></li>
<li class="level1"><a href="#sec_lists">Lists and cons cells</a></li>
<li class="level1"><a href="#sec_arrays">Arrays</a></li>
<li class="level1"><a href="#sec_pattern">Pattern-matching</a></li>
<li class="level1"><a href="#sec_concurrency">Concurrency</a></li>
<li class="level1"><a href="#sec_messages">Message-passing</a></li>
<li class="level1"><a href="#sec_unparse">Unparsable symbols</a></li>
<li class="level1"><a href="#sec_types">Types</a></li>
<li class="level1"><a href="#sec_internal">Internal symbols</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="sec_arith"></a>
Arithmetic</h1>
<p><a class="anchor" id="+"></a> </p><h3>+</h3>
<p>Adds up an aribtrary number of values. The form of a + expression is <code>(+ expr1 ... exprN)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Example adding up two numbers. The result is 3. <div class="fragment"><div class="line">(+ 1 2)</div></div><!-- fragment --> When adding up values of different types values are converted. <div class="fragment"><div class="line">(+ 1i28 3.14)</div></div><!-- fragment --> The example above evaluates to float value 4.14.<br />
 You can add up multiple values. <div class="fragment"><div class="line">(+ 1 2 3 4 5 6 7 8 9 10)</div></div><!-- fragment --> The example above results in the value 55.</dd></dl>
<hr/>
<p><a class="anchor" id="-"></a> </p><h3>-</h3>
<p>Subtract an arbitrary number of values from a value. The form of a - expression is <code>(- expr1 ... exprN)</code></p>
<dl class="section note"><dt>Note</dt><dd>Example subtracting 3 from 5. <div class="fragment"><div class="line">(- 5 3)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="*"></a> </p><h3>*</h3>
<p>Multiplying an arbitrary number of values. The form of a * expression is <code>(* expr1 ... exprN)</code></p>
<dl class="section note"><dt>Note</dt><dd>Example 2pi. <div class="fragment"><div class="line">(* 2 3.14)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="/"></a> </p><h3>/</h3>
<p>Division. The form of a / expression is <code>(/ expr1 ... exprN)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Divide 128 by 2 <div class="fragment"><div class="line">(/ 128 2)</div></div><!-- fragment --> The following example evaluates to 1. <div class="fragment"><div class="line">(/ 128 2 2 2 2 2 2 2)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="mod"></a> </p><h3>mod</h3>
<p>Modulo operation. The form of a mod expression is <code>(mod expr1 ... exprN)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Compute 5 % 3, evaluates to 2. <div class="fragment"><div class="line">(mod 5 3)</div></div><!-- fragment --></dd></dl>
<hr/>
<h1><a class="anchor" id="sec_comp"></a>
Comparisons</h1>
<p><a class="anchor" id="="></a> </p><h3>=</h3>
<p>Compare expressions for equality. The = implements structural equality. The for of an = expression is <code>(= expr1 ... exprN)</code></p>
<dl class="section note"><dt>Note</dt><dd>Compare the result of <code>(+ 1 2)</code> with 3. The result of this comparison is <code>t</code>. <div class="fragment"><div class="line">(= (+ 1 2) 3)</div></div><!-- fragment --> Multiple expressions can be checked at once. The examples below evaluates to <code>t</code> <div class="fragment"><div class="line">(= 1 1 1 1)</div><div class="line"></div><div class="line">(= (+ 3 4) (+ 2 5) (+ 1 6))</div></div><!-- fragment --> The following examples evaluate to <code>nil</code> representing false. <div class="fragment"><div class="line">(= 1 1 1 1 2)</div><div class="line"></div><div class="line">(= (+ 1 2) (+ 0 2) (+ -1 2))</div></div><!-- fragment --> The = comparison can be used on tree shaped data. The following expression evaluates to <code>t</code>. <div class="fragment"><div class="line">(= <span class="stringliteral">&#39;(1 (1 2)) &#39;</span>(1 (1 2)))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="num-eq"></a> </p><h3>num-eq</h3>
<p>The <code>num-eq</code> operation can only be used on numerical arguments. For numerical arguments <code>num-eq</code> behaves like <a href="#=">=</a>. If you know you are comparing numbers, it will be more efficient to use <code>num-eq</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Example of <code>num-eq</code> comparison. <div class="fragment"><div class="line">(num-eq (+ 2 3) (+ 1 4))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id=">"></a> </p><h3>&gt;</h3>
<p>Greater than comparison. A greater than comparison has the form <code>(&gt; expr1 ... exprN)</code> and evaluates to <code>t</code> if expr1 is greater than all of expr2 ... exprN.</p>
<dl class="section note"><dt>Note</dt><dd>Example <div class="fragment"><div class="line">(&gt; 5 2)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="<"></a> </p><h3>&lt;</h3>
<p>Less than comparison. A less than comparison has the form <code>(&gt; expr1 ... exprN)</code> and evaluates to <code>t</code> if expr1 is less than all of expr2 ... exprN.</p>
<dl class="section note"><dt>Note</dt><dd>Example <div class="fragment"><div class="line">(&lt; 5 2)</div></div><!-- fragment --></dd></dl>
<hr/>
<h1><a class="anchor" id="sec_bool"></a>
Boolean operators</h1>
<p><a class="anchor" id="and"></a> </p><h3>and</h3>
<p>Boolean <code>and</code> operation between n arguments. The form of an <code>and</code> expression is <code>(and expr1 ... exprN)</code>. This operation treats all non-nil values as true. Boolean <code>and</code> is "shirt-circuiting" and only evaluates until a false is encountered.</p>
<dl class="section note"><dt>Note</dt><dd>The example below evaluates to <code>t</code> <div class="fragment"><div class="line">(and t t)</div></div><!-- fragment --> The folowing example evaluates to 3 <div class="fragment"><div class="line">(and t t (+ 1 2))</div></div><!-- fragment --> And lastly an example that evaluates to nil (for false). <div class="fragment"><div class="line">(and t (&lt; 5 3))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="or"></a> </p><h3>or</h3>
<p>Boolean <code>or</code> operation between n arguments. The form of an <code>or</code> expression is <code>(or expr1 ... exprN)</code>. This operation treats all non-nil values as true. Boolean <code>or</code> is "short-circuiting" and only evaluates until a true is encountered.</p>
<dl class="section note"><dt>Note</dt><dd>The example below evaluates to <code>t</code>. <div class="fragment"><div class="line">(or t nil)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="not"></a> </p><h3>not</h3>
<p>Boolean <code>not</code> takes one argument. The form of a <code>not</code> expression is <code>(not expr)</code>. All non-nil values are considered true.</p>
<dl class="section note"><dt>Note</dt><dd>The following example evaluates to <code>t</code> <div class="fragment"><div class="line">(not nil)</div></div><!-- fragment --></dd></dl>
<hr/>
<h1><a class="anchor" id="sec_bitwise"></a>
Bit level operations</h1>
<p><a class="anchor" id="shl"></a></p><h3>shl</h3>
<p>The shift left operation takes two arguments. The first argument is a value to shift and the second argument is the number of bit positions to shift the value. </p><dl class="section note"><dt>Note</dt><dd>The example below evaluates to 4. <div class="fragment"><div class="line">(shl 1 2)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="shr"></a></p><h3>shr</h3>
<p>The shift right operation takes two arguments. The first argument is a value to shift and the second argument in the number of bit positions to shift the value. </p><dl class="section note"><dt>Note</dt><dd>The example below evaluates to 1. <div class="fragment"><div class="line">(shr 4 2)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="bitwise-and"></a></p><h3>bitwise-and</h3>
<p>Performs the bitwise and operation between two values. The type of the result is the same type as the first of the arguments.</p>
<hr/>
<p><a class="anchor" id="bitwise-or"></a></p><h3>bitwise-or</h3>
<p>Performs the bitwise or operation between two values. The type of the result is the same type as the first of the arguments.</p>
<hr/>
<p><a class="anchor" id="bitwise-xor"></a></p><h3>bitwise-xor</h3>
<p>Performs the bitwise xor operation between two values. The type of the result is the same type as the first of the arguments.</p>
<hr/>
<p><a class="anchor" id="bitwise-not"></a></p><h3>bitwise-not</h3>
<p>Performs the bitwise not operations on a value. The result is of same type as the argument.</p>
<h1><a class="anchor" id="sec_low_level"></a>
Low level operations</h1>
<p><a class="anchor" id="encode-i32"></a> </p><h3>encode-i32</h3>
<p>The <code>encode-i32</code> function converts a list of four (byte sized) values into an i32 value. </p><dl class="section note"><dt>Note</dt><dd>Example that evaluates to the i32 value 1024. <div class="fragment"><div class="line">(encode-i32 (list 0 0 4 0))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="encode-u32"></a> </p><h3>encode-u32</h3>
<p>The <code>encode-u32</code> function converts a list of four (byte sized) values into an u32 value. </p><dl class="section note"><dt>Note</dt><dd>Example that evaluates to the u32 value 1024. <div class="fragment"><div class="line">(encode-u32 (list 0 0 4 0))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="encode-float"></a> </p><h3>encode-float</h3>
<p>The <code>encode-float</code> function converts a list four (byte sized) values into a float value. </p><dl class="section note"><dt>Note</dt><dd>Example that evaluates to 3.14. <div class="fragment"><div class="line">(encode-float (list 64 72 245 195))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="decode"></a> </p><h3>decode</h3>
<p>The <code>decode</code> function decodes a value into a list of four (byte sized) values. </p><dl class="section note"><dt>Note</dt><dd>Example that decodes float 3.14 into the list (64 72 245 195). <div class="fragment"><div class="line">(decode 3.14)</div></div><!-- fragment --></dd></dl>
<hr/>
<h1><a class="anchor" id="sec_nil"></a>
nil and t</h1>
<p><a class="anchor" id="nil"></a></p><h3>nil</h3>
<p>Represents the empty list. The nil value is also considered to be false by conditionals<br />
</p>
<dl class="section note"><dt>Note</dt><dd>The example below creates a one element list by allocating a cons cell and putting a value (1) in the <a href="#car">car </a> field and nil in the <a href="#cdr">cdr </a> field.<br />
 <div class="fragment"><div class="line">(cons 1 nil)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="t"></a></p><h3>t</h3>
<p>All non nil values are considered true in conditionals. t should be used in cases where an explicit true makes sense. </p><hr/>
<h1><a class="anchor" id="sec_quote"></a>
Quotes and Quasiquotation</h1>
<p>Code and data share the same representation, it is only a matter of how you look at it. The tools for changing how your view are the quotation and quasiquotation operations. </p><hr/>
<p><a class="anchor" id="'"></a></p><h3>'</h3>
<p><a class="anchor" id="quote"></a></p>
<p>Usages of the ' quote symbol in input code is replaced with the symbol quote by the reader. <br />
 Evaluating a quoted expression, (quote a), results in a unevaluated.<br />
 </p><dl class="section note"><dt>Note</dt><dd>The program string <code>'(+ 1 2) </code> gets read into the heap as the list <code>(quote (+ 1 2))</code>.<br />
 Evaluating the expression <code>(quote (+ 1 2))</code> results in the value <code>(+ 1 2)</code>.</dd></dl>
<hr/>
<p><a class="anchor" id="`"></a></p><h3>`</h3>
<p>The backwards tick <code>`</code> is called the quasiquote. It is similar to the <code>'</code> but allows splicing in results of computations using the <a href="#,">,</a> and the <a href="#commaat">,@</a> operators.</p>
<dl class="section note"><dt>Note</dt><dd>The result of <code>'(+ 1 2)</code> and <code>`(+ 1 2)</code> are similar in effect. Both result in the result value of <code>(+ 1 2)</code>, that is a list containing +, 1 and 2. <br />
 When <code>`(+ 1 2)</code> is read into the heap it is expanded into the expression <code>(append (quote (+)) (append (quote (1)) (append (quote (2)) (quote nil))))</code> which evaluates to the list <code>(+ 1 2)</code>.</dd></dl>
<hr/>
<p><a class="anchor" id=","></a></p><h3>,</h3>
<p>The comma is used to splice the result of a computation into a quasiquotation. </p><dl class="section note"><dt>Note</dt><dd>The expression <code>`(+ 1 ,(+ 1 1))</code> is expanded by the reader into <code>(append (quote (+)) (append (quote (1)) (append (list (+ 1 1)) (quote nil))))</code>. Evaluating the expression above results in the list <code>(+ 1 2)</code>.</dd></dl>
<hr/>
<p><a class="anchor" id="commaat"></a></p><h3>,@</h3>
<p>The comma-at operation is used to splice in the result of a computation (that returns a list) into a list. </p><dl class="section note"><dt>Note</dt><dd>Example: <div class="fragment"><div class="line">(define mylist (list 1 2 3 4 5)</div><div class="line">`(9 6 5 ,@mylist)</div></div><!-- fragment --> Evaluates to the list <code>(9 6 5 1 2 3 4 5)</code>.</dd></dl>
<h1><a class="anchor" id="sec_builtin"></a>
Built-in operations</h1>
<p><a class="anchor" id="eval"></a> </p><h3>eval</h3>
<hr/>
<p><a class="anchor" id="eval-program"></a> </p><h3>eval-program</h3>
<hr/>
<p><a class="anchor" id="type-of"></a> </p><h3>type-of</h3>
<hr/>
<p><a class="anchor" id="sym-to-str"></a> </p><h3>sym-to-str</h3>
<hr/>
<p><a class="anchor" id="str-to-sym"></a> </p><h3>str-to-sym</h3>
<hr/>
<p><a class="anchor" id="sym-to-u"></a> </p><h3>sym-to-u</h3>
<hr/>
<p><a class="anchor" id="u-to-sym"></a> </p><h3>u-to-sym</h3>
<hr/>
<p><a class="anchor" id="is-fundamental"></a> </p><h3>is-fundamental</h3>
<hr/>
<h1><a class="anchor" id="sec_forms"></a>
Special forms</h1>
<p><a class="anchor" id="if"></a> </p><h3>if</h3>
<p>Conditionals are written as <code>(if cond-expr then-expr else-expr)</code>. If the cond-expr evaluates to <a href="#nil">nil </a> the else-expr will be evaluated. for any other value of cond-expr the then-expr will be evalated.</p>
<dl class="section note"><dt>Note</dt><dd>The example below evaluates to 0 if a is less than or equal to 4. Otherwise it evaluates to a + 10. <div class="fragment"><div class="line">(<span class="keywordflow">if</span> (&gt; a 4) (+ a 10) 0)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="lambda"></a> </p><h3>lambda</h3>
<p>You create an anonymous function with lambda. The function can be given a name by binding the lambda expression using <a href="#define">define</a> or <a href="#let">let</a>. A lambda expression has the form <code>(lambda param-list body-expr)</code>. </p><dl class="section note"><dt>Note</dt><dd>The example shows an anonymous function that adds one. <div class="fragment"><div class="line">(lambda (x) (+ x 1))</div></div><!-- fragment --> A lambda can be immediately applied to an argument. <div class="fragment"><div class="line">((lambda (x) (+ x 1)) 10)</div></div><!-- fragment --> The application above results in the value 11. <br />
 Using <a href="#define">define </a> you can give a name to the function. <div class="fragment"><div class="line">(define inc (lambda (x) (+ x 1)))</div></div><!-- fragment --> Now the expression <code>(inc 10)</code> computes the result 11.</dd></dl>
<hr/>
<p><a class="anchor" id="closure"></a> </p><h3>closure</h3>
<p>A <a href="#lambda">lambda </a> expression evaluates into a closure which is very similar to a <a href="#lambda">lambda</a> but extended with a captured environment for any names unbound in the param-list appearing in the body-expr. The form of a closure is <code>(closure param-list body-exp environment)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Evaluation of the expression <div class="fragment"><div class="line">(lambda (x) (+ x 1))</div></div><!-- fragment --> results in the value <div class="fragment"><div class="line">(closure (x) (+ x 1) nil)</div></div><!-- fragment --><br />
 Below is an example of how a value is captured into the closure. <div class="fragment"><div class="line">(let ((a 1)) (lambda (x) (+ x a)))</div></div><!-- fragment --> The expression above evaluates to the following. Note that <code>(a . 1)</code> appears in the closure. <div class="fragment"><div class="line">(closure (x) (+ x a) ((a . 1)))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="let"></a> </p><h3>let</h3>
<p>Local environments are created using let. The let binding in lispbm allows for mutually recursive bindings. The form of a let is <code>(let list-of-bindings body-expr)</code> and evaluating this expression means that body-expr is evaluted in an environment extended with the list-of-bindings.</p>
<dl class="section note"><dt>Note</dt><dd>Example that evaluates to 3. <div class="fragment"><div class="line">(let ((a 1)</div><div class="line">      (b 2))</div><div class="line">  (+ a b))</div></div><!-- fragment --> Below is a more advanced example of two mutually recursive functions created in a let binding. <div class="fragment"><div class="line">(let ((f (lambda (x) (<span class="keywordflow">if</span> (= x 0) 0 (g (- x 1)))))</div><div class="line">      (g (lambda (x) (<span class="keywordflow">if</span> (= x 0) 1 (f (- x 1))))))</div><div class="line">  (f 11))</div></div><!-- fragment --> The mutually recursive program above evaluates to 1.</dd></dl>
<hr/>
<p><a class="anchor" id="define"></a> </p><h3>define</h3>
<p>You can give names to values in a global scope by using define. The form of define is <code>(define name expr)</code>. The expr is evaluated and it is the result of the evaluated expr that is stored in the environment. In lispbm you can redefine already defined values.</p>
<dl class="section note"><dt>Note</dt><dd>Example <div class="fragment"><div class="line">(define apa 10)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="progn"></a> </p><h3>progn</h3>
<p>The progn special form allows you to sequence a number of expressions. The form of a progn expression is: </p><div class="fragment"><div class="line">(progn expr1</div><div class="line">       expr2</div><div class="line">       ...</div><div class="line">       exprN)</div></div><!-- fragment --><p> The evaluation result of a progn sequence is the value that the last <code>exprN</code> evaluated to. This is useful for sequencing of side-effecting operations.</p>
<dl class="section note"><dt>Note</dt><dd>Simple example that evaluates to 3. <div class="fragment"><div class="line">(progn 1</div><div class="line">       2</div><div class="line">       3)</div></div><!-- fragment --> An example where side effects are sequenced. <div class="fragment"><div class="line">(progn (define a 10)</div><div class="line">       (define b 20)</div><div class="line">       (+ a b))</div></div><!-- fragment --> This program evaluates 30 but also extends the global environment with the 2 bindings <code>(a 10)</code> and <code>(b 20)</code> created using <a href="#define">define</a>.</dd></dl>
<hr/>
<p><a class="anchor" id="read"></a> </p><h3>read</h3>
<p>Parses a string resulting in either an expression or the <a href="#read_error">read_error</a> in case the string can not be parsed into an expression. The form of a read expression is <code>(read string)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>The example below evaluates to the value 1. <div class="fragment"><div class="line">(read <span class="stringliteral">&quot;1&quot;</span>)</div></div><!-- fragment --> You can also read code. <div class="fragment"><div class="line">(read <span class="stringliteral">&quot;(lambda (x) (+ x 1))&quot;</span>)</div></div><!-- fragment --> That lambda you just read in from a string can be directly applied to an argument. <div class="fragment"><div class="line">((read <span class="stringliteral">&quot;(lambda (x) (+ x 1))&quot;</span>) 10)</div></div><!-- fragment --> The code above evaluates to 11.</dd></dl>
<hr/>
<p><a class="anchor" id="read-program"></a> </p><h3>read-program</h3>
<p>Parses a string containing multiple sequenced expressed. The resulting list of expressions can be evaluated as a program using <a href="#eval-program">eval-program</a>. The form of a read-program expression is <code>(read-program string)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Evaluate a program you just read from a string with <a href="#eval-program">eval-program</a>. <div class="fragment"><div class="line">(eval-program (read-program <span class="stringliteral">&quot;(define apa 1) (+ 2 apa)&quot;</span>))</div></div><!-- fragment --> The expression above evaluates to 3 with the side effect that the global environment has been extended with the binding <code>(apa 1)</code>.</dd></dl>
<hr/>
<h1><a class="anchor" id="sec_lists"></a>
Lists and cons cells</h1>
<p>Lists are build using cons cells. A cons cell is represented by the <a class="el" href="structlbm__cons__t.html">lbm_cons_t</a> struct in the implementation and consists of two fields named the <code>car</code> and the <code>cdr</code>. There is no special meaning associated with the <code>car</code> and the <code>cdr</code> each can hold a <a class="el" href="lbm__types_8h.html#aff516ca015a2565197543383355a7a06">lbm_value</a>. See <a href="#cons">cons</a> and <a href="#list">list</a> for two ways to create structures of cons cells on the heap.</p>
<p><a class="anchor" id="car"></a> </p><h3>car</h3>
<p>Use <code>car</code> to access the <code>car</code> field of a cons cell. A <code>car</code> expression has the form <code>(car expr)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Taking the <code>car</code> of a number of symbol type is in general a <a href="#type_error">type_error</a>. The following program results in <code>type_error</code>. <div class="fragment"><div class="line">(car 1)</div></div><!-- fragment --> The next example evaluates to 1. <div class="fragment"><div class="line">(car (cons 1 2))</div></div><!-- fragment --> The <code>car</code> operation accesses the head element of a list. The following program evaluates to 9. <div class="fragment"><div class="line">(car (list 9 8 7))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="cdr"></a> </p><h3>cdr</h3>
<p>Use <code>cdr</code> to access the <code>cdr</code> field of a cons cell. A <code>cdr</code> expression has the form <code>(cdr expr)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>The example below evaluates to 2. <div class="fragment"><div class="line">(cdr (cons 1 2))</div></div><!-- fragment --> The <code>cdr</code> operation gives you the rest of a list. The example below evaluates to the list (8 7). <div class="fragment"><div class="line">(cdr (list 9 8 7))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="cons"></a> </p><h3>cons</h3>
<p>The <code>cons</code> operation allocates a cons cell from the heap and populates the <code>car</code> and the <code>cdr</code> fields of this cell with its two arguments. The form of a <code>cons</code> expression is <code>(cons expr1 expr2)</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Build the list <code>(1 2 3)</code> using cons. <a href="#nil">nil</a> terminates a proper list. <div class="fragment"><div class="line">(cons 1 (cons 2 (cons 3 nil)))</div></div><!-- fragment --> Construct the pair <code>(+ . 1)</code> using cons. <div class="fragment"><div class="line">(cons + 1)</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="."></a> </p><h3>.</h3>
<hr/>
<p><a class="anchor" id="list"></a> </p><h3>list</h3>
<hr/>
<p><a class="anchor" id="append"></a> </p><h3>append</h3>
<hr/>
<p><a class="anchor" id="ix"></a> </p><h3>ix</h3>
<hr/>
<p><a class="anchor" id="set-car"></a> </p><h3>set-car</h3>
<hr/>
<p><a class="anchor" id="set-cdr"></a> </p><h3>set-cdr</h3>
<h1><a class="anchor" id="sec_arrays"></a>
Arrays</h1>
<p><a class="anchor" id="array-read"></a> </p><h3>array-read</h3>
<hr/>
<p><a class="anchor" id="array-write"></a> </p><h3>array-write</h3>
<hr/>
<h1><a class="anchor" id="sec_pattern"></a>
Pattern-matching</h1>
<p><a class="anchor" id="match"></a> </p><h3>match</h3>
<p>Pattern-matching is expressed using match. The form of a match expression is <code>(match expr (pat1 expr1) ... (patN exprN))</code>. Pattern-matching compares the shape of an expression to each of the <code>pat1</code> ... <code>patN</code> and evaluates the expression <code>exprM</code> of the pattern that matches. In a pattern you can use a number of match-binders or wildcards: <a href="#_">_</a>, <a href="#?">?</a>, <a href="#?i28">?i28</a>, <a href="#?u28">?u28</a>, <a href="#?float">?float</a>, <a href="#?cons">?cons</a>.</p>
<dl class="section note"><dt>Note</dt><dd>For example the match expression below evaluates to 2. <div class="fragment"><div class="line">(match <span class="stringliteral">&#39;orange</span></div><div class="line"><span class="stringliteral">       (green 1)</span></div><div class="line"><span class="stringliteral">       (orange 2)</span></div><div class="line"><span class="stringliteral">       (blue 3))</span></div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="_"></a> </p><h3>_</h3>
<p>The underscore pattern matches anything.</p>
<dl class="section note"><dt>Note</dt><dd>An example that evaluates to <code>i-dont-know</code> <div class="fragment"><div class="line">(match <span class="stringliteral">&#39;fish</span></div><div class="line"><span class="stringliteral">       (horse &#39;</span>its-a-horse)</div><div class="line">       (pig <span class="stringliteral">&#39;its-a-pig)</span></div><div class="line"><span class="stringliteral">       (_ &#39;</span>i-dont-know))</div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="?"></a> </p><h3>?</h3>
<p>The ? pattern matches anything and binds that anything to variable. Using the ? pattern is done as <code>(? var)</code> and the part of the expression that matches is bound to <code>var</code>.</p>
<dl class="section note"><dt>Note</dt><dd>An example that evaluates to 19. <div class="fragment"><div class="line">(match <span class="stringliteral">&#39;(orange 17)</span></div><div class="line"><span class="stringliteral">       ((green (? n)) (+ n 1))</span></div><div class="line"><span class="stringliteral">       ((orange (? n)) (+ n 2))</span></div><div class="line"><span class="stringliteral">       ((blue (? n)) (+ n 3)))</span></div></div><!-- fragment --> <hr/>
</dd></dl>
<p><a class="anchor" id="?i28"></a> </p><h3>?i28</h3>
<p>The ?i28 pattern matches any i28 and binds that value to a variable. Using the ?i28 pattern is done as <code>(?i28 var)</code> and the part of the expression that matches is bound to the <code>var</code>.</p>
<dl class="section note"><dt>Note</dt><dd>The following example evaluates to <code>not-an-i28</code>. <div class="fragment"><div class="line">(match 3.14</div><div class="line">       ( (i28 n) (+ n 1))</div><div class="line">       ( _ <span class="stringliteral">&#39;not-an-i28))</span></div></div><!-- fragment --> The example below evaluates to 5. <div class="fragment"><div class="line">(match 4</div><div class="line">       ( (i28 n) (+ n 1))</div><div class="line">       ( _ <span class="stringliteral">&#39;not-an-i28))</span></div></div><!-- fragment --></dd></dl>
<hr/>
<p><a class="anchor" id="?u28"></a> </p><h3>?u28</h3>
<p>The ?u28 pattern matches any u28 and binds that value to a variable. Using the ?u28 pattern is done as <code>(?u28 var)</code> and the part of the expression that matches is bound to the <code>var</code>.</p>
<hr/>
<p><a class="anchor" id="?float"></a> </p><h3>?float</h3>
<p>The ?float pattern matches any float and binds that value to a variable. Using the ?float pattern is done as <code>(?float var)</code> and the part of the expression that matches is bound to the <code>var</code>. </p><hr/>
<h1><a class="anchor" id="sec_concurrency"></a>
Concurrency</h1>
<p><a class="anchor" id="spawn"></a> </p><h3>spawn</h3>
<hr/>
<p><a class="anchor" id="wait"></a> </p><h3>wait</h3>
<hr/>
<p><a class="anchor" id="yield"></a> </p><h3>yield</h3>
<hr/>
<h1><a class="anchor" id="sec_messages"></a>
Message-passing</h1>
<p><a class="anchor" id="send"></a> </p><h3>send</h3>
<hr/>
<p><a class="anchor" id="recv"></a> </p><h3>recv</h3>
<h1><a class="anchor" id="sec_unparse"></a>
Unparsable symbols</h1>
<p>Unparsable symbols cannot be written into a program. The unparsable symbols signals different kinds of error conditions that may point at something being wrong in the code (or that it is exhausting all resources).</p>
<p><a class="anchor" id="no_match"></a> </p><h3>no_match</h3>
<p>The <code>no_match</code> symbol is returned from pattern matching if no case matches the expression.</p>
<hr/>
<p><a class="anchor" id="read_error"></a> </p><h3>read_error</h3>
<p>The <code>read_error</code> symbol is returned if the reader cannot parse the input code.</p>
<hr/>
<p><a class="anchor" id="type_error"></a> </p><h3>type_error</h3>
<p>The <code>type_error</code> symbol is returned byt built-in functions if the values passed in are of incompatible types. </p><hr/>
<p><a class="anchor" id="eval_error"></a> </p><h3>eval_error</h3>
<p>The <code>eval_error</code> symbol is returned if evaluation could not proceed to evaluate the expression. This could be because the expression is malformed. </p><hr/>
<p><a class="anchor" id="out_of_memory"></a> </p><h3>out_of_memory</h3>
<p>The <code>out_of_memory</code> symbol is returned if the heap is full and running the garbage collector was not able to free any memory up. The program uses more memory than the size of the heap. Make the heap larger. </p><hr/>
<p><a class="anchor" id="fatal_error"></a> </p><h3>fatal_error</h3>
<p>The <code>fatal_error</code> symbol is returned in cases where the LispBM runtime system cannot proceed. Something is corrupt and it is not safe to continue. </p><hr/>
<p><a class="anchor" id="out_of_stack"></a> </p><h3>out_of_stack</h3>
<p>The <code>out_of_stack</code> symbol is returned if the evaluator runs out of continuation stack (this is its runtime-stack). You are most likely writing a non-tail-recursive function that is exhausting all the resources. </p><hr/>
<p><a class="anchor" id="division_by_zero"></a> </p><h3>division_by_zero</h3>
<p>The <code>division_by_zero</code> symbol is returned when dividing by zero. </p><hr/>
<p><a class="anchor" id="variable_not_bound"></a> </p><h3>variable_not_bound</h3>
<p>The <code>variable_not_bound</code> symbol is returned when evaluating a variable (symbol) that is neighter bound nor special (built-in function).</p>
<h1><a class="anchor" id="sec_types"></a>
Types</h1>
<p><a class="anchor" id="type-list"></a> </p><h3>type-list</h3>
<hr/>
<p><a class="anchor" id="type-i28"></a> </p><h3>type-i28</h3>
<hr/>
<p><a class="anchor" id="type-u28"></a> </p><h3>type-u28</h3>
<hr/>
<p><a class="anchor" id="type-float"></a> </p><h3>type-float</h3>
<hr/>
<p><a class="anchor" id="type-i32"></a> </p><h3>type-i32</h3>
<hr/>
<p><a class="anchor" id="type-u32"></a> </p><h3>type-u32</h3>
<hr/>
<p><a class="anchor" id="type-array"></a> </p><h3>type-array</h3>
<hr/>
<p><a class="anchor" id="type-symbol"></a> </p><h3>type-symbol</h3>
<hr/>
<p><a class="anchor" id="type-char"></a> </p><h3>type-char</h3>
<hr/>
<p><a class="anchor" id="type-ref"></a> </p><h3>type-ref</h3>
<hr/>
<p><a class="anchor" id="type-stream"></a> </p><h3>type-stream</h3>
<hr/>
<h1><a class="anchor" id="sec_internal"></a>
Internal symbols</h1>
<p><a class="anchor" id="sym_openpar"></a> </p><h3>sym_openpar</h3>
<hr/>
<p><a class="anchor" id="sym_closepar"></a> </p><h3>sym_closepar</h3>
<hr/>
<p> <a class="anchor" id="sym_backquote"></a> </p><h3>sym_backquote</h3>
<hr/>
<p><a class="anchor" id="sym_comma"></a> </p><h3>sym_comma</h3>
<hr/>
<p><a class="anchor" id="sym_commaat"></a> </p><h3>sym_commaat</h3>
<hr/>
<p><a class="anchor" id="sym_dot"></a> </p><h3>sym_dot</h3>
<hr/>
<p><a class="anchor" id="sym_tok_done"></a> </p><h3>sym_tok_done</h3>
<hr/>
<p><a class="anchor" id="sym_array"></a> </p><h3>sym_array</h3>
<hr/>
<p><a class="anchor" id="sym_boxed_i"></a> </p><h3>sym_boxed_i</h3>
<hr/>
<p><a class="anchor" id="sym_boxed_u"></a> </p><h3>sym_boxed_u</h3>
<hr/>
<p><a class="anchor" id="sym_boxed_f"></a> </p><h3>sym_boxed_f</h3>
<hr/>
<p><a class="anchor" id="sym_ref"></a> </p><h3>sym_ref</h3>
<hr/>
<p><a class="anchor" id="sym_recovered"></a> </p><h3>sym_recovered</h3>
<hr/>
<p><a class="anchor" id="sym_nonsense"></a> </p><h3>sym_nonsense</h3>
<hr/>
 </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
